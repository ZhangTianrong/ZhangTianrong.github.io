---
layout:		post
title:		Cryptography in History
subtitle:	Cryptography-Course-Note-1
date:		2020-01-12
catalog:	true
tags:
	- CourseNote
	- Cryptography
	- English
---

## Introduction

This series is a collection of notes of the course **Introduction to Cryptography** delivered at University of Michigan in Winter 2020. The textbook used is *Introduction to modern cryptography* of Jonathan Katz from University of Maryland - Park. The course will familiarize us with the famous algorithms in cryptography and prepare us for further study into cryptography.

Historically, cryptography refers to the art of creating and solving codes. However, such definition can not capture the current breadth of the field any more, as modern cryptography keeps including more topics like designing mechanisms for ensuring integrity, devising protocols for authenticating identity, etc. Therefore, rather than trying to provide a complete definition of modern cryptography, we firstly briefly trace the history of it and find out what are developed through time.

## Historical Ciphers and Their Cryptanalysis

Classical cryptography was meant to deal with code design for the scenario where there is a need to communicate secretly in the presence of eavesdroppers who can monitor the channel used, and the security of classical encryption schemes relied on a key shared by the communicating parties in advance and unknown to the eavesdroppers. So, this scenario is called shared-key/private-key setting and the encryption method is known as shared-key encryption.

### Shared-key encryption

A shared-key encryption scheme is defined by message space $\mathcal{M}$, key-generation algorithm $\tt{Gen}$, encryption algorithm $\tt{Enc}$ and decryption algorithm $\tt{Dec}$, such that $\forall k\in\mathcal{K}, \forall m\in\mathcal{M}, {\tt Dec}_k({\tt Enc}_k(m)) = m$ where $\mathcal{K}$ is the space of all possible keys that can be generated by $\tt Gen$ and accepted by $\tt{Enc,Dec}$.

### Kerchhoff's principle

> The cipher method must not be required to be secret, and it must be able to fall into the hands of the enemy without inconvenience.

There are three primary arguments in favor of Kerchoff's principle:

1. Keys are significantly easier to maintain secrecy of than the algorithm.
2. Keys can be replaced much easier than the algorithm if exposed.
3. Standardized algorithms evolve and improve through public scrutiny.

### Caesar's cipher and Sufficient Key-Space Principle

The original Caesar's cipher is known as ROT-3 in that it shifts the alphabet order by 3 positions. ROT-3 itself doesn't even have a key, which makes it decryptable effortlessly as long as one knows the algorithm. As a keyed generalization of Caesars's cipher, shift cipher apply ROT-$k$ based on the generated key $k$. However, shift cipher is not much safer than Caesar's. $|\mathcal{K}|$ is as small as $26$ for example in English. This makes an exhaustive-search well affordable. Hence, to further evaluate a encryption scheme, we introduce the following principle:

> Any secure encryption scheme must have a key space that is sufficiently large to make exhaustive-search attack infeasible.

The principle is only vaguely stated and closely related to the computing power of the attacker. The key space can be as large as $2^{70}$ or even larger to be considered infeasible for exhaustive-search.

### Mono-alphabetic Substitution Cipher and Frequency Analysis

Instead of shifting the order, the key of mono-alphabetic substitution cipher can be arbitrary permutations of the alphabet, which introduces $26~\approx2^{88}$ possible keys in English. However, this is still easily attackable in that characters occurrences follow informative statistical patterns in any language. Even in a short corpus, the statistical pattern gives a rather good approximation to the frequencies of characters. In this way, after sorting the statistical probability $p$ and the frequencies in ciphered text $q$, the mapping relationship can be easily approximated.

Frequency analysis can also be used to decode shift ciphers more systematically. Consider computing
$$
I_j = \sum_{i=0}^{25}p_i\cdot q_{i+j\text{ mod 26}}
$$
for $j\in[26]$. When $j =$ the real key $k$, $I_k\approx\sum_{i=0}^{25}p_i^2 = C$ which is a known value. For $j$ being other values, $I_j$ should deviate from $C$ more. Then, by selecting the $j$ that generates closest $I_j$ to $C$, we approximate $k$ without the knowledge of the language beyond $p_i$s. This is extremely helpful in Kasiski test that follows as well.

### The Vigenere (poly-alphabetic shift) cipher and Kasiski test

To overcome the weakness of mono-alphabetic substitution cipher due to its fixed character-wise mapping, in Vigenere cipher a key is a string $\in\mathcal{M}$; it can be repeated or truncated to the length of the plain text message and then the character in each position is shifted according to the character in the extended/shortened key to obtain the ciphered text. This encryption scheme was considered unbreakable until centuries after its creation in the $16^\mathrm{th}$ when a systematic attack was devised.

The Kasiski test makes use of the repeating pattern in Vigenere cipher. Consider if we already know the length of the key $n$; then decoding Vigenere cipher reduces to decoding $n$ shift ciphers. Though the $n$ ciphered texts aren't comprised of consecutive characters in the original message, by using frequency analysis, we can still decode them.

To find $n$, note that frequently repeated words will be observed encoded to the same ciphered text given long enough messages. 

Recall how we solve the [repeating and non-overlapping substring problem](https://www.geeksforgeeks.org/longest-repeating-and-non-overlapping-substring/) with prefix tree and then by collecting all the non-overlapping repeated substrings, we gain some idea about the length of $k$. For instance, if we see a substring frequently, then $n$ will probably be  among the common devisors of the sizes of intervals between each 2 occurrences. This reduces the number of case to search greatly.

## Supplementary Material

### Enigma code

The famous Enigma code used by German in WWâ…¡ can be thought of as an extended and modified version of Vigenere cipher. [Here](https://www.youtube.com/watch?v=mcX7iO_XCFA) is a video about the inner wiring of Enigma machines

<iframe width="560" height="315" align="middle" src="https://www.youtube.com/embed/mcX7iO_XCFA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

and [this](https://www.youtube.com/watch?v=V4V2bpZlqx8) other video discusses the flaw in Enigma code

<iframe width="560" height="315" align="middle" src="https://www.youtube.com/embed/G2_Q9FoD-oQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

